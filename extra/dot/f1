static void version (void)
static void usage (void)
static int parse_options (int argc, char **argv)
static void ntfs_name_print (ntfschar *name, int name_len)
static void ntfs_dir_print (struct ntfs_dir *dir, int indent)
static void ntfs_dt_print (struct ntfs_dt *dt, int indent)
static void ntfs_binary_print (u8 num, BOOL backwards, BOOL colour)
static const char *ntfsinfo_time_to_str(const s64 sle_ntfs_clock)
static void ntfs_inode_dir_map (ntfs_inode *ino)
static ntfs_inode *ntfs_inode_open2 (ntfs_volume *vol, const MFT_REF mref)
static int ntfs_inode_close2 (ntfs_inode *ni)
static int ntfs_bmp_rollback (struct ntfs_bmp *bmp)
static int ntfs_bmp_commit (struct ntfs_bmp *bmp)
static void ntfs_bmp_free (struct ntfs_bmp *bmp)
static struct ntfs_bmp * ntfs_bmp_alloc (ntfs_inode *inode, ATTR_TYPES type, ntfschar *name, int name_len)
static int ntfs_bmp_add_data (struct ntfs_bmp *bmp, VCN vcn, u8 *data)
static u8 * ntfs_bmp_get_data (struct ntfs_bmp *bmp, VCN vcn)
static int ntfs_bmp_set_range (struct ntfs_bmp *bmp, VCN vcn, s64 length, int value)
static s64 ntfs_bmp_find_last_set (struct ntfs_bmp *bmp)
static VCN ntfs_ie_get_vcn (INDEX_ENTRY *ie)
static void ntfs_ie_dump (INDEX_ENTRY *ie)
static INDEX_ENTRY * ntfs_ie_create (void)
static INDEX_ENTRY * ntfs_ie_copy (INDEX_ENTRY *ie)
static INDEX_ENTRY * ntfs_ie_set_vcn (INDEX_ENTRY *ie, VCN vcn)
static INDEX_ENTRY * ntfs_ie_remove_vcn (INDEX_ENTRY *ie)
static INDEX_ENTRY * ntfs_ie_set_name (INDEX_ENTRY *ie, ntfschar *name, int namelen, FILE_NAME_TYPE_FLAGS nametype)
static INDEX_ENTRY * ntfs_ie_remove_name (INDEX_ENTRY *ie)
static int ntfs_ie_test (void)
static void ntfs_dt_free (struct ntfs_dt *dt)
static int ntfs_dt_rollback (struct ntfs_dt *dt)
static int ntfs_dt_commit (struct ntfs_dt *dt)
static INDEX_ENTRY ** ntfs_dt_alloc_children (INDEX_ENTRY **children, int count)
static BOOL ntfs_dt_alloc_children2 (struct ntfs_dt *dt, int count)
static int ntfs_dt_count_root (struct ntfs_dt *dt)
static int ntfs_dt_count_alloc (struct ntfs_dt *dt)
static struct ntfs_dt * ntfs_dt_alloc (struct ntfs_dir *dir, struct ntfs_dt *parent, VCN vcn)
static MFT_REF ntfs_dt_find (struct ntfs_dt *dt, ntfschar *name, int name_len)
static struct ntfs_dt * ntfs_dt_find2 (struct ntfs_dt *dt, ntfschar *name, int name_len, int *index_num)
static struct ntfs_dt * ntfs_dt_find3 (struct ntfs_dt *dt, ntfschar *name, int name_len, int *index_num)
static struct ntfs_dt * ntfs_dt_find4 (struct ntfs_dt *dt, ntfschar *name, int name_len, int *index_num)
static void ntfs_dt_find_all (struct ntfs_dt *dt)
static int ntfs_dt_find_parent (struct ntfs_dt *dt)
static BOOL ntfs_dt_root (struct ntfs_dt *dt)
static int ntfs_dt_freespace_root (struct ntfs_dt *dt)
static int ntfs_dt_freespace_alloc (struct ntfs_dt *dt)
static int ntfs_dt_initialise (struct ntfs_dt *dt, VCN vcn)
static int ntfs_dt_transfer (struct ntfs_dt *old, struct ntfs_dt *new, int start, int count)
static int utils_free_non_residents (ntfs_inode *inode)
static int utils_free_non_residents3 (struct ntfs_bmp *bmp, ntfs_inode *inode, ATTR_RECORD *attr)
static int utils_free_non_residents2 (ntfs_inode *inode, struct ntfs_bmp *bmp)
static int utils_mftrec_mark_free (ntfs_volume *vol, MFT_REF mref)
static int utils_mftrec_mark_free2 (ntfs_volume *vol, MFT_REF mref)
static int utils_mftrec_mark_free3 (struct ntfs_bmp *bmp, MFT_REF mref)
static int utils_mftrec_mark_free4 (ntfs_inode *inode)
static int utils_mftrec_mark_free5 (ntfs_inode *inode, struct ntfs_bmp *bmp, MFT_REF mref)
static int ntfs_mft_remove_attr (struct ntfs_bmp *bmp, ntfs_inode *inode, ATTR_TYPES type)
static int ntfs_mft_resize_resident (ntfs_inode *inode, ATTR_TYPES type, ntfschar *name, int name_len, u8 *data, int data_len)
static int ntfs_mft_free_space (struct ntfs_dir *dir)
static int ntfs_dt_root_replace (struct ntfs_dt *del, int del_num, INDEX_ENTRY *del_ie, INDEX_ENTRY *suc_ie)
static BOOL ntfs_dt_alloc_replace (struct ntfs_dt *del, int del_num, INDEX_ENTRY *del_ie, INDEX_ENTRY *suc_ie)
static BOOL ntfs_dt_root_remove (struct ntfs_dt *del, int del_num)
static BOOL ntfs_dt_alloc_remove (struct ntfs_dt *del, int del_num)
static int ntfs_dt_root_add (struct ntfs_dt *add, INDEX_ENTRY *add_ie)
static int ntfs_dt_alloc_add (struct ntfs_dt *add, INDEX_ENTRY *add_ie)
static int ntfs_dt_remove_alloc (struct ntfs_dt *dt, int index_num)
static int ntfs_dt_remove_root (struct ntfs_dt *dt, int index_num)
static int ntfs_dt_remove (struct ntfs_dt *dt, int index_num)
static int ntfs_dt_del_child (struct ntfs_dt *dt, ntfschar *uname, int len)
static int ntfs_dt_add_alloc (struct ntfs_dt *parent, int index_num, INDEX_ENTRY *ie, struct ntfs_dt *child)
static int ntfs_dt_add_root (struct ntfs_dt *parent, int index_num, INDEX_ENTRY *ie, struct ntfs_dt *child)
static int ntfs_dt_add (struct ntfs_dt *parent, INDEX_ENTRY *ie)
static int ntfs_dt_add2 (INDEX_ENTRY *ie, struct ntfs_dt *suc, int suc_num, struct ntfs_dt *ded)
static int ntfs_dir_rollback (struct ntfs_dir *dir)
static int ntfs_dir_truncate (ntfs_volume *vol, struct ntfs_dir *dir)
static int ntfs_dir_commit (struct ntfs_dir *dir)
static void ntfs_dir_free (struct ntfs_dir *dir)
static struct ntfs_dir * ntfs_dir_alloc (ntfs_volume *vol, MFT_REF mft_num)
static void ntfs_dir_add (struct ntfs_dir *parent, struct ntfs_dir *child)
static MFT_REF ntfs_dir_find (struct ntfs_dir *dir, char *name)
static struct ntfs_dir * ntfs_dir_find2 (struct ntfs_dir *dir, ntfschar *name, int name_len)
static int utils_volume_commit (ntfs_volume *vol)
static int utils_volume_rollback (ntfs_volume *vol)
static MFT_REF utils_pathname_to_mftref (ntfs_volume *vol, struct ntfs_dir *parent, const char *pathname, struct ntfs_dir **finddir)
static int ntfs_umount2 (ntfs_volume *vol, const BOOL force)
static ntfs_volume * utils_mount_volume2 (const char *device, unsigned long flags, BOOL force)
static BOOL utils_pathname_to_inode2 (ntfs_volume *vol, struct ntfs_dir *parent, const char *pathname, struct ntfs_find *found)
static int ntfsrm (ntfs_volume *vol, char *name)
static int ntfs_index_dump_alloc (ntfs_attr *attr, VCN vcn, int indent)
static int ntfs_index_dump (ntfs_inode *inode)
static int ntfs_file_add (ntfs_volume *vol, char *name)
static int ntfs_file_remove (ntfs_volume *vol, struct ntfs_dt *del, int del_num)
static int ntfs_file_remove2 (ntfs_volume *vol, struct ntfs_dt *dt, int dt_num)
static int ntfs_test_bmp (ntfs_volume *vol, ntfs_inode *inode)
static int ntfs_test_bmp2 (ntfs_volume *vol)
